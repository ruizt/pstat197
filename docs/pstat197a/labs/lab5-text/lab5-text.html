<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Text processing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">
      Data Science Capstone
      </li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../../../index.html" class="sidebar-logo-link">
      <img src="../../../img/ucsbds_hex.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../../../">Data Science Capstone</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/pstat197" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
    <a href="https://ucsbdscapstone.slack.com" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-slack"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../people.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">People</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">Projects</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../projects/projects-22-23.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2022-2023 Projects</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../projects/projects-21-22.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2021-2022 Projects</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../projects/projects-20-21.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2020-2021 Projects</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">Class materials</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">PSTAT197A</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../pstat197a/about-syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course syllabus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../pstat197a/about-materials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Materials</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">PSTAT197B-C</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../pstat197bc/about-syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course syllabus</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#text-preprocessing" id="toc-text-preprocessing" class="nav-link active" data-scroll-target="#text-preprocessing">Text preprocessing</a>
  <ul class="collapse">
  <li><a href="#distinguishing-documents" id="toc-distinguishing-documents" class="nav-link" data-scroll-target="#distinguishing-documents">Distinguishing documents</a></li>
  <li><a href="#collapsing-lines-and-cleaning-text" id="toc-collapsing-lines-and-cleaning-text" class="nav-link" data-scroll-target="#collapsing-lines-and-cleaning-text">Collapsing lines and cleaning text</a></li>
  </ul></li>
  <li><a href="#basic-nlp" id="toc-basic-nlp" class="nav-link" data-scroll-target="#basic-nlp">Basic NLP</a>
  <ul class="collapse">
  <li><a href="#tokenization" id="toc-tokenization" class="nav-link" data-scroll-target="#tokenization">Tokenization</a></li>
  <li><a href="#frequency-measures" id="toc-frequency-measures" class="nav-link" data-scroll-target="#frequency-measures">Frequency measures</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Text processing</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>In this lab you’ll learn some basic text processing following what was presented in class and do a little exploratory analysis using token frequency measures.</p>
<p><strong>Objectives</strong></p>
<ul>
<li><p>use <code>stringr</code> functions for pattern matching to clean up raw text</p></li>
<li><p>use <code>tidytext</code> , <code>stopwords</code> , and <code>textstem</code> for tokenization, stopword removal, and lemmatization</p></li>
<li><p>compute descriptive summaries of texts based on frequency measures: TF, IDF, and TF-IDF</p></li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Action
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Setup for lab</strong></p>
<p>Open RStudio.</p>
<ol type="1">
<li>We’ll need a few additional packages that weren’t installed in the first lab. In the console, execute the following commands:</li>
</ol>
<div class="cell" data-hash="lab5-text_cache/html/unnamed-chunk-1_56e23156630a1b2b1ce5e69d15d2d7f7">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">'https://raw.githubusercontent.com/pstat197/pstat197a/main/materials/scripts/package-installs.R'</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Create a new script in your lab directory and copy-paste the code chunk below. Execute once.</li>
</ol>
</div>
</div>
<div class="cell" data-hash="lab5-text_cache/html/unnamed-chunk-2_ea3df8c3e264524d438a69c0e35ac0f0">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># setup</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytext)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tokenizers)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(textstem)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stopwords)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">'https://raw.githubusercontent.com/pstat197/pstat197a/main/materials/labs/lab5-text/data/drseuss.txt'</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># read data</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>seuss_lines <span class="ot">&lt;-</span> <span class="fu">read_lines</span>(url, <span class="at">skip_empty_rows =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The text we’ll work with comprises four Dr.&nbsp;Seuss books. The raw data are read in line-by-line, so that <code>seuss_lines</code> is a vector in which each element is a line from one of the four books. Lines are rendered in order.</p>
<div class="cell" data-hash="lab5-text_cache/html/unnamed-chunk-3_735f9f9939f46ada8af8000927f42046">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>seuss_lines <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The Cat in the Hat"            "By Dr. Seuss"                 
[3] "The sun did not shine."        "It was too wet to play."      
[5] "So we sat in the house"        "All that cold, cold, wet day."</code></pre>
</div>
</div>
<section id="text-preprocessing" class="level2">
<h2 class="anchored" data-anchor-id="text-preprocessing">Text preprocessing</h2>
<p>For us, ‘preprocessing’ operations will refer to coercing a document into one long uniformly-formatted string.</p>
<section id="distinguishing-documents" class="level3">
<h3 class="anchored" data-anchor-id="distinguishing-documents">Distinguishing documents</h3>
<p>To start, we have all four books lumped together. A quick visual scan of the text file will confirm that each book is set off by the title on one line followed by ‘By Dr.&nbsp;Seuss’ on the next line.</p>
<p>We can leverage this structure to distinguish the books: the chunk below</p>
<ul>
<li><p>creates a ‘flag’ by pattern-matching each line with <code>Dr. Seuss</code>,</p></li>
<li><p>then shifts the lines down by one so that the flag matches the title line instead of the author line</p></li>
<li><p>then assigns a document ID to each line by computing the total number of flags in all preceding lines.</p></li>
</ul>
<p>The last two commands correct for having ‘lagged’ the lines.</p>
<div class="cell" data-hash="lab5-text_cache/html/unnamed-chunk-4_af1753368256f22844b482170874524b">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># flag lines with a document id</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>seuss_lines_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">line_lag =</span> <span class="fu">c</span>(seuss_lines, <span class="cn">NA</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">flag =</span> <span class="fu">str_detect</span>(line_lag, <span class="st">'Dr. Seuss'</span>),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">line =</span> <span class="fu">lag</span>(line_lag, <span class="at">n =</span> <span class="dv">1</span>),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">doc =</span> <span class="fu">cumsum</span>(flag)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(doc, line) <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill</span>(doc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We may as well assign labels to the document IDs.</p>
<div class="cell" data-hash="lab5-text_cache/html/unnamed-chunk-5_24babaedb129c961382e39cc2b082a08">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># grab titles</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>titles <span class="ot">&lt;-</span> seuss_lines_df <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(doc) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(line) <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tolower</span>()</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># label docs</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>seuss_lines_df <span class="ot">&lt;-</span> seuss_lines_df <span class="sc">%&gt;%</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">doc =</span> <span class="fu">factor</span>(doc, <span class="at">labels =</span> titles))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, we’ll strip the title and author information, because all books are by the same author and the title is now recorded in the document ID.</p>
<p>The chunk below adds a document-specific line number and removes the first two lines from every document. Since each row is a line, this amounts to a simple row numbering and filtering.</p>
<div class="cell" data-hash="lab5-text_cache/html/unnamed-chunk-6_0d6c8e2f9b6fff93c6609c4a216d49ae">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove header lines (title/author)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>seuss_lines_clean <span class="ot">&lt;-</span> seuss_lines_df <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(doc) <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">line_num =</span> <span class="fu">row_number</span>() <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(line_num <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Action
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Line summaries</strong></p>
<p>See if you can answer the following questions:</p>
<ol type="1">
<li>How many lines are in each book?</li>
<li>How many lines in each book contain the word ‘bump’?</li>
</ol>
<p>Work with a neighbor. <em>Hint</em>: you might find it handy to use <code>str_detect()</code> , and grouped operations and/or summaries.</p>
</div>
</div>
</section>
<section id="collapsing-lines-and-cleaning-text" class="level3">
<h3 class="anchored" data-anchor-id="collapsing-lines-and-cleaning-text">Collapsing lines and cleaning text</h3>
<p>First, concatenate all the lines using <code>str_c()</code> .</p>
<div class="cell" data-hash="lab5-text_cache/html/unnamed-chunk-7_7f4dda9e3eb2ef44d013f2905446e830">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># collapse lines into one long string</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>seuss_text <span class="ot">&lt;-</span> seuss_lines_clean <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">text =</span> <span class="fu">str_c</span>(line, <span class="at">collapse =</span> <span class="st">' '</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this case the resulting text strings for each document don’t contain too many elements in need of removal: just punctuation and capital letters.</p>
<div class="cell" data-hash="lab5-text_cache/html/unnamed-chunk-8_350c54963d8b00c2985e4db6cfa97a97">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>cat_in_hat <span class="ot">&lt;-</span> seuss_text <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To strip these elements, we can exclude matching patterns from the collection of punctuation marks and then use <code>tolower()</code> to replace upper-case letters with lower-case letters. Shorthand for punctuation in <code>stringr</code> is <code>'[[:punct:]]'</code> .</p>
<div class="cell" data-hash="lab5-text_cache/html/unnamed-chunk-9_4564717c80529862ed3cc06e238a4963">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>cat_in_hat <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_remove_all</span>(<span class="st">'[[:punct:]]'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tolower</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "the sun did not shine it was too wet to play so we sat in the house all that cold cold wet day i sat there with sally we sat there we two and i said how i wish we had something to do too wet to go out and too cold to play ball so we sat in the house we did nothing at all so all we could do was to sit sit sit sit and we did not like it not one little bit bump and then something went bump how that bump made us jump we looked then we saw him step in on the mat we looked and we saw him the cat in the hat and he said to us why do you sit there like that i know it is wet and the sun is not sunny but we can have lots of good fun that is funny i know some good games we could play said the cat i know some new tricks said the cat in the hat a lot of good tricks i will show them to you your mother will not mind at all if i do then sally and i did not know what to say our mother was out of the house for the day but our fish said no no make that cat go away tell that cat in the hat you do not want to play he should not be here he should not be about he should not be here when your mother is out now now have no fear have no fear said the cat my tricks are not bad said the cat in the hat why we can have lots of good fun if you wish with a game that i call upupup with a fish put me down said the fish this is no fun at all put me down said the fish i do not wish to fall have no fear said the cat i will not let you fall i will hold you up high as i stand on a ball with a book on one hand and a cup on my hat but that is not all i can do said the cat look at me look at me now said the cat with a cup and a cake on the top of my hat i can hold up two books i can hold up the fish and a litte toy ship and some milk on a dish and look i can hop up and down on the ball but that is not all oh no that is not all look at me look at me look at me now it is fun to have fun but you have to know how i can hold up the cup and the milk and the cake i can hold up these books and the fish on a rake i can hold the toy ship and a little toy man and look with my tail i can hold a red fan i can fan with the fan as i hop on the ball but that is not all oh no that is not all that is what the cat said then he fell on his head he came down with a bump from up there on the ball and sally and i we saw all the things fall and our fish came down too he fell into a pot he said do i like this oh no i do not this is not a good game said our fish as he lit no i do not like it not one little bit now look what you did said the fish to the cat now look at this house look at this look at that you sank our toy ship sank it deep in the cake you shook up our house and you bent our new rake you should not be here when our mother is not you get out of this house said the fish in the pot but i like to be here oh i like it a lot said the cat in the hat to the fish in the pot i will not go away i do not wish to go and so said the cat in the hat so so so i will show you another good game that i know and then he ran out and then fast as a fox the cat in the hat came back in with a box a big red wood box it was shut with a hook now look at this trick said the cat take a look then he got up on top with a tip of his hat i call this game funinabox said the cat in this box are two things i will show to you now you will like these two things said the cat with a bow i will pick up the hook you will see something new two things and i call them thing one and thing two these things will not bite you they want to have fun then out of the box came thing two and thing one and they ran to us fast they said how do you do would you like to shake hands with thing one and thing two and sally and i did not know what to do so we had to shake hands with thing one and thing two we shook their two hands but our fish said no no those things should not be in this house make them go they should not be here when your mother is not put them out put them out said the fish in the pot have no fear little fish said the cat in the hat these things are good things and he gave them a pat they are tame oh so tame they have come here to play they will give you some fun on this wet wet wet day now here is a game that they like said the cat they like to fly kites said the cat in the hat no not in the house said the fish in the pot they should not fly kites in a house they should not oh the things they will bump oh the things they will hit oh i do not like it not one little bit then sally and i saw them run down the hall we saw those two things bump their kites on the wall bump thump thump bump down the wall in the hall thing two and thing one they ran up they ran down on the string of one kite we saw mothers new gown her gown with the dots that are pink white and red then we saw one kite bump on the head of her bed then those things ran about with big bumps jumps and kicks and with hops and big thumps and all kinds of bad tricks and i said i do not like the way that they play if mother could see this oh what would she say then our fish said look look and our fish shook with fear your mother is on her way home do you hear oh what will she do to us what will she say oh she will not like it to find us this way so do something fast said the fish do you hear i saw her your mother your mother is near so as fast as you can think of something to do you will have to get rid of thing one and thing two so as fast as i could i went after my net and i said with my net i can get them i bet i bet with my net i can get those things yet then i let down my net it came down with a plop and i had them at last thoe two things had to stop then i said to the cat now you do as i say you pack up those things and you take them away oh dear said the cat you did not like our game oh dear what a shame what a shame what a shame then he shut up the things in the box with the hook and the cat went away with a sad kind of look that is good said the fish he has gone away yes but your mother will come she will find this big mess and this mess is so big and so deep and so tall we ca not pick it up there is no way at all and then who was back in the house why the cat have no fear of this mess said the cat in the hat i always pick up all my playthings and so i will show you another good trick that i know then we saw him pick up all the things that were down he picked up the cake and the rake and the gown and the milk and the strings and the books and the dish and the fan and the cup and the ship and the fish and he put them away then he said that is that and then he was gone with a tip of his hat then our mother came in and she said to us two did you have any fun tell me what did you do and sally and i did not know what to say should we tell her the things that went on there that day should we tell her about it now what should we do well what would you do if your mother asked you"</code></pre>
</div>
</div>
<p>To apply this to all four texts, simply create a function wrapper for the processing commands and then use <code>dplyr</code> to pass the text through the processing function.</p>
<div class="cell" data-hash="lab5-text_cache/html/unnamed-chunk-10_bfcc2a17d28a7f1b493b66193dbc14ef">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>clean_fn <span class="ot">&lt;-</span> <span class="cf">function</span>(.text){</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_remove_all</span>(.text, <span class="st">'[[:punct:]]'</span>) <span class="sc">%&gt;%</span> <span class="fu">tolower</span>()</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>seuss_text_clean <span class="ot">&lt;-</span> seuss_text <span class="sc">%&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">text =</span> <span class="fu">clean_fn</span>(text))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You could also create a manual list of punctuation to remove.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Action
</div>
</div>
<div class="callout-body-container callout-body">
<p>The regular expression for matching <code>a</code> or <code>b</code> is <code>a | b</code> . Write an alternative to the previous code chunk that lists the punctuation to remove explicitly and <em>does not</em> use <code>'[[:punct:]]'</code> .</p>
</div>
</div>
</section>
</section>
<section id="basic-nlp" class="level2">
<h2 class="anchored" data-anchor-id="basic-nlp">Basic NLP</h2>
<p>As you saw in class, once we have a string of clean text for each document, tokenization and lemmatization are largely automated.</p>
<section id="tokenization" class="level3">
<h3 class="anchored" data-anchor-id="tokenization">Tokenization</h3>
<p><code>unnest_tokens()</code> will tokenize and return the result in tidy format; <code>lemmatize_words()</code> can be applied to the resulting column of tokens using <code>dplyr</code> commands.</p>
<div class="cell" data-hash="lab5-text_cache/html/unnamed-chunk-11_64fb02efbdaa8092de05714a22aef56b">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>stpwrd <span class="ot">&lt;-</span> stop_words <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(word) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_remove_all</span>(<span class="st">'[[:punct:]]'</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>seuss_tokens_long <span class="ot">&lt;-</span> seuss_text_clean <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_tokens</span>(<span class="at">output =</span> token, <span class="co"># specifies new column name</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">input =</span> text, <span class="co"># specifies column containing text</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">token =</span> <span class="st">'words'</span>, <span class="co"># how to tokenize</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">stopwords =</span> stpwrd) <span class="sc">%&gt;%</span> <span class="co"># optional stopword removal</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">token =</span> <span class="fu">lemmatize_words</span>(token)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Action
</div>
</div>
<div class="callout-body-container callout-body">
<p>Based on the data frame above, use row counting (<code>count()</code> ) to answer the following questions:</p>
<ol type="1">
<li>What’s the most frequently used word in each book?</li>
<li>What’s the most frequently used word in all books?</li>
</ol>
<p>Compare with your neighbor to check your answers.</p>
<p><strong><em>If there’s time:</em></strong> refer to the documentation <code>?unnest_tokens</code> to determine how to tokenize as bigrams. Find the most frequent bigrams in each book.</p>
</div>
</div>
</section>
<section id="frequency-measures" class="level3">
<h3 class="anchored" data-anchor-id="frequency-measures">Frequency measures</h3>
<p>The frequency measures discussed in class – term frequency (TF), inverse document frequency (IDF), and their product (TF-IDF) – can be computed from token counts using <code>tidytext::bind_tf_idf()</code> .</p>
<div class="cell" data-hash="lab5-text_cache/html/unnamed-chunk-12_159ebf6a0fea18151001727d0f1d91c6">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>seuss_tfidf <span class="ot">&lt;-</span> seuss_tokens_long <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(doc, token) <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_tf_idf</span>(<span class="at">term =</span> token,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">document =</span> doc,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">n =</span> n) </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>seuss_df <span class="ot">&lt;-</span> seuss_tfidf <span class="sc">%&gt;%</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> doc, </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_from =</span> token,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> tf_idf,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fill =</span> <span class="dv">0</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>seuss_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 246
  doc         bad    ball     bed    bend     bet    bite   book     bow     box
  &lt;fct&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 "the c… 0.00396 0.00990 0.00198 0.00198 0.00792 0.00792 0.0158 0.00396 0.00411
2 "fox i… 0       0       0       0.00891 0       0       0      0       0.00431
3 "green… 0       0       0       0       0       0       0      0       0.0139 
4 "hop o… 0.00788 0.0118  0.0118  0       0       0.00394 0      0       0      
# … with 236 more variables: bump &lt;dbl&gt;, ca &lt;dbl&gt;, cake &lt;dbl&gt;, call &lt;dbl&gt;,
#   cat &lt;dbl&gt;, cold &lt;dbl&gt;, cup &lt;dbl&gt;, day &lt;dbl&gt;, dear &lt;dbl&gt;, deep &lt;dbl&gt;,
#   dish &lt;dbl&gt;, dot &lt;dbl&gt;, fall &lt;dbl&gt;, fan &lt;dbl&gt;, fast &lt;dbl&gt;, fear &lt;dbl&gt;,
#   fish &lt;dbl&gt;, fly &lt;dbl&gt;, fox &lt;dbl&gt;, fun &lt;dbl&gt;, funinabox &lt;dbl&gt;, funny &lt;dbl&gt;,
#   game &lt;dbl&gt;, gown &lt;dbl&gt;, hall &lt;dbl&gt;, hand &lt;dbl&gt;, hat &lt;dbl&gt;, head &lt;dbl&gt;,
#   hear &lt;dbl&gt;, hit &lt;dbl&gt;, hold &lt;dbl&gt;, home &lt;dbl&gt;, hook &lt;dbl&gt;, hop &lt;dbl&gt;,
#   house &lt;dbl&gt;, jump &lt;dbl&gt;, kick &lt;dbl&gt;, kind &lt;dbl&gt;, kite &lt;dbl&gt;, light &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p>We can use this data to compute a variety of summaries of the text. For example, the two words that distinguish each book most from the other books are, by book:</p>
<div class="cell" data-hash="lab5-text_cache/html/unnamed-chunk-13_11449e1cef3c86e2df8649af8fff9376">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>seuss_tfidf <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(doc) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(tf_idf, <span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 6
# Groups:   doc [4]
   doc                  token      n     tf   idf tf_idf
   &lt;fct&gt;                &lt;chr&gt;  &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 "the cat in the hat" cat       26 0.0743 0.693 0.0515
 2 "the cat in the hat" fish      20 0.0571 0.693 0.0396
 3 "fox in socks "      sir       37 0.0792 1.39  0.110 
 4 "fox in socks "      sock      19 0.0407 1.39  0.0564
 5 "green eggs and ham" samiam    13 0.0897 1.39  0.124 
 6 "green eggs and ham" egg       10 0.0690 1.39  0.0956
 7 "green eggs and ham" green     10 0.0690 1.39  0.0956
 8 "green eggs and ham" ham       10 0.0690 1.39  0.0956
 9 "hop on pop"         brown     10 0.0568 1.39  0.0788
10 "hop on pop"         pup        8 0.0455 1.39  0.0630</code></pre>
</div>
</div>
<p>But the two most common words in each book are:</p>
<div class="cell" data-hash="lab5-text_cache/html/unnamed-chunk-14_2f5b0eb48b0065836a589ed3699d20b2">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>seuss_tfidf <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(doc) <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(tf, <span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 6
# Groups:   doc [4]
  doc                  token      n     tf   idf tf_idf
  &lt;fct&gt;                &lt;chr&gt;  &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 "the cat in the hat" cat       26 0.0743 0.693 0.0515
2 "the cat in the hat" fish      20 0.0571 0.693 0.0396
3 "fox in socks "      sir       37 0.0792 1.39  0.110 
4 "fox in socks "      sock      19 0.0407 1.39  0.0564
5 "green eggs and ham" eat       24 0.166  0.288 0.0476
6 "green eggs and ham" samiam    13 0.0897 1.39  0.124 
7 "hop on pop"         brown     10 0.0568 1.39  0.0788
8 "hop on pop"         pat       10 0.0568 0.693 0.0394</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Action
</div>
</div>
<div class="callout-body-container callout-body">
<p>Discuss with your neighbor how you might determine how ‘different’ any two books are using an appropriate frequency measure and comparison between rows.</p>
<ol type="1">
<li>Compute your difference measure for all pairs of books. Which pair is most distinct?</li>
<li>Use the same idea to compute difference from the ‘average’ Dr.&nbsp;Seuss book. Which book is most different from the rest?</li>
</ol>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">© 2023 Trevor Ruiz</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>